{"version":3,"sources":["../src/sanityClient.js"],"names":["assign","require","Patch","Transaction","dataMethods","DatasetsClient","ProjectsClient","AssetsClient","UsersClient","AuthClient","httpRequest","getRequestOptions","defaultConfig","initConfig","SanityClient","config","assets","datasets","projects","users","auth","prototype","newConfig","clientConfig","getUrl","uri","url","replace","request","options","requestObservable","toPromise","clone","mergedConfig","mergeOptions","opts","headers","reduce","merged","createClient","module","exports"],"mappings":"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","file":"sanityClient.js","sourcesContent":["const assign = require('xtend/mutable')\nconst Patch = require('./data/patch')\nconst Transaction = require('./data/transaction')\nconst dataMethods = require('./data/dataMethods')\nconst DatasetsClient = require('./datasets/datasetsClient')\nconst ProjectsClient = require('./projects/projectsClient')\nconst AssetsClient = require('./assets/assetsClient')\nconst UsersClient = require('./users/usersClient')\nconst AuthClient = require('./auth/authClient')\nconst httpRequest = require('./http/request')\nconst getRequestOptions = require('./http/requestOptions')\nconst {defaultConfig, initConfig} = require('./config')\n\nfunction SanityClient(config = defaultConfig) {\n  this.config(config)\n\n  this.assets = new AssetsClient(this)\n  this.datasets = new DatasetsClient(this)\n  this.projects = new ProjectsClient(this)\n  this.users = new UsersClient(this)\n  this.auth = new AuthClient(this)\n}\n\nassign(SanityClient.prototype, dataMethods)\nassign(SanityClient.prototype, {\n  config(newConfig) {\n    if (typeof newConfig === 'undefined') {\n      return this.clientConfig\n    }\n\n    this.clientConfig = initConfig(newConfig, this.clientConfig || {})\n    return this\n  },\n\n  getUrl(uri) {\n    return `${this.clientConfig.url}/${uri.replace(/^\\//, '')}`\n  },\n\n  request(options) {\n    return this.requestObservable(options).toPromise()\n  },\n\n  clone(newConfig) {\n    const mergedConfig = assign(this.config(), newConfig || {})\n    return new SanityClient(mergedConfig)\n  },\n\n  requestObservable(options) {\n    return httpRequest(mergeOptions(\n      getRequestOptions(this.clientConfig),\n      options,\n      {uri: this.getUrl(options.uri)}\n    ))\n  }\n})\n\n// Merge http options and headers\nfunction mergeOptions(...opts) {\n  const headers = opts.reduce((merged, options) => {\n    if (!merged && !options.headers) {\n      return null\n    }\n    return assign(merged || {}, options.headers || {})\n  }, null)\n  return assign(...opts, headers ? {headers} : {})\n}\n\nfunction createClient(config) {\n  return new SanityClient(config)\n}\n\ncreateClient.Patch = Patch\ncreateClient.Transaction = Transaction\n\nmodule.exports = createClient\n"]}